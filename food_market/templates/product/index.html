<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Products</title>
    <link rel="stylesheet" href="{% static 'css/products.css' %}">
</head>
<body>
    <p id="something">500000</p>
    <button onclick="update_number()">Update</button>
    <form action="" method="GET">
        <input type="text" name="name" placeholder="Search by name">
        <select name="category">
            <option value="None">------</option>
            {% for subcategory in subcategories %}
            <option value="{{ subcategory.id }}">{{ subcategory.name }}</option>
            {% endfor %}
        </select>
        <input type="number" name="from" placeholder="from">
        <input type="number" name="to" placeholder="to">
        <select name="sort">
            <option value="title+">Name +</option>
            <option value="likes+">Likes +</option>
            <option value="price+">Price +</option>
            <option value="title-">Name -</option>
            <option value="likes-">Likes -</option>
            <option value="price-">Price -</option>
        </select>
        <input type="submit" value="Search">
    </form>
    {% if products %}
        {% for product in products %}
            <div class="products">
                    <a href="{{ product.title }}">
                        <h3>{{ product.title }}</h3><br>
                        <img src="{{ product.image.url }}" width="200px"><br>
                        <p>{{ product.description }}</p><br>
                        <p>Likes: {{ product.likes }}</p><br>
                        <p>Price: {{ product.price }}</p><br>
                    </a>
                    <a href="{% url 'subcategory' product.subcategory %}">Subcategory - {{ product.subcategory }}</a>
                </div>
        {% endfor %}
    {% endif %}
    <script>
        var number = '500000';

        function update_number() {
            number = '500000';
        }
        
        function loadDoc() {
          var xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                number = JSON.parse(this.responseText)['number'];
              document.getElementById("something").innerHTML = number;
            }
          };
          xhttp.open("GET", "get_json?number=" + number, true);
          xhttp.send();
        }

        setInterval(loadDoc, 100);
    </script>
</body>
</html>